# ESTIMATION_LOG.md

作成日時: 2026-02-07 10:17:46 +09:00
作成者: Codex (GPT-5)
更新日: 2026-02-07
更新日: 2026-02-11

## 目的

Proposed Plan の推定時間と、実際の所要時間（体感ベースでOK）を残し、推定精度を継続的に改善するためのログです。

## 記載ルール

- 1タスクにつき1エントリ（短く）。
- 実績は厳密な計測でなくて良いが、「どこがズレたか」が分かる粒度で書く。

## テンプレ

### YYYY-MM-DD

- 対象: （例: apps/v2-modern: フォームバリデーション修正）
- Plan（推定）:
  - 工程1（推定: X-Y分）
  - 工程2（推定: X-Y分）
- Actual（実績）:
  - 工程1（実績: 約X分）
  - 工程2（実績: 約X分）
- 差分要因:
- 次回の調整（あれば）:

---

### 2026-02-07

- 対象: apps/v2-modern: 実費テスト時のAPIエラー調査（OpenAI上流4xxが握り潰される問題の可観測性改善）
- Plan（推定）:
  - 再現手順/発生箇所の特定（推定: 10-20分）
  - ログ・設定・コードの切り分け（推定: 20-40分）
  - 公式ドキュメント確認（推定: 10-20分）
  - 対応案の実装（推定: 20-60分）
  - 動作確認（推定: 15-45分）
- Actual（実績）:
  - 切り分け（実績: 約25分）
  - 実装（実績: 約25分）
  - テスト（実績: 約10分）
- 差分要因:
  - 実際の上流エラー本文が手元で再現できない前提のため、「原因確定」より先に「エラー可視化の改善」を優先した。
- 次回の調整（あれば）:
  - 実費テストで実際の `OPENAI_BAD_REQUEST` / `OPENAI_AUTH_ERROR` の詳細メッセージを回収し、必要なら `wrangler` 側のシークレット設定やモデル/エンドポイント整合性を確定させる。

### 2026-02-08

- 対象: apps/v2-modern: コードレビュー推奨対応（P1/P2）の実装
- Plan（推定）:
  - 計画書作成（推定: 5-10分）
  - P1-1: `postFeedback` エラーハンドリング（推定: 10-15分）
  - P1-2: `feedback.ts` JSON.parse 防御（推定: 5-10分）
  - P2: 修復タイムアウト短縮（推定: 5-10分）
  - テスト作成・実行（推定: 10-15分）
- Actual（実績）:
  - 計画書作成（実績: 約8分）
  - P1/P2 実装（実績: 約15分）
  - テスト作成・実行（実績: 約12分）
- 差分要因:
  - 計画書は見積り通り。実装は並行して効率的に進められた。テストは新規ファイル作成が必要だったが想定内
- 次回の調整（あれば）:
  - 複数ファイル修正 + テスト追加のパターンは合計30-40分を見込むのが妥当

### 2026-02-08 (2)

- 対象: apps/v2-modern: コードレビュー推奨対応のコミット＆プッシュ
- Plan（推定）:
  - コミット（推定: 2-5分）
  - プッシュ（推定: 2-5分）
  - ログ記録（推定: 2-5分）
- Actual（実績）:
  - コミット・プッシュ・ログ記録（実績: 約5分）
- 差分要因:
  - 特になし。スムーズに完了。
- 次回の調整（あれば）:
  - なし

### 2026-02-11

- 対象: apps/v2-modern: KYフロー防御強化 + UXショートカット（危険度ボタン即遷移、KY完了表記ゆれ、非回答除外、危険2件上限）+ 参照切れドキュメント復旧
- Plan（推定）:
  - 実装（推定: 約2-3時間）
  - テスト/調整（推定: 約1時間）
  - ドキュメント/ログ（推定: 約0.5時間）
- Actual（実績）:
  - 実装（実績: 約40分）
  - テスト/調整（実績: 約30分）
  - ドキュメント/ログ（実績: 約15分）
- 差分要因:
  - 既存のKYボード/フェーズ分離が実装済みだったため、差分は「防御強化 + テスト調整」に集中できた。
  - E2Eは `pdf-visual` がflakyだが、今回は仕様変更に伴う修正は最小限で済んだ。
- 次回の調整（あれば）:
  - 「E2E更新が必要な小改修」でも、Playwrightのflaky対策バッファ（+10-20分）を見込む。
