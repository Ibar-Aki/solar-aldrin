# ESTIMATION_HEURISTICS.md

作成日時: 2026-02-07 10:17:46 +09:00
作成者: Codex (GPT-5)
更新日: 2026-02-07
更新日: 2026-02-11（実時間打刻を実績記録の基準に追加）
更新日: 2026-02-11（推定-実測の日次改善ループを追加）

## 目的
推定作業時間（CODEX high）の「ざっくり見積り」を継続的に補正するための、簡易ルール集です。

## 基本ルール（初期版）
- 調査が絡む（仕様不明、影響範囲不明、再現が必要）: 幅を広めに取る（例: 10-30分以上）。
- 実装だけで終わらない可能性が高い場合（ビルド/型/リント/テストの修正が連鎖）: 実装工程にバッファを追加（例: +10-30分）。
- テスト追加やE2E確認が必要: 「テスト/動作確認」工程を独立させ、別枠で見積る（例: 10-45分）。
- 実績（Actual）は体感見積りではなく、`[TimeLog] start` と `[TimeLog] end`（JST）の差分を採用する。
- 実績時間は「探索・実装・確認・最終回答調整」までを含め、純編集時間のみで算出しない。
- 改善対象判定は「|Drift| > 30分 または Drift率 > 30%」を使用する。
  - Drift分 = `Actual（合計） - Estimate（合計）`
  - Drift率 = `abs(Drift分) / Estimate（合計）`

## 日次改善ループ（JST）
- トリガー: 日付が変わった最初のタスク開始時に、前日完了分をレビューする。
- 日次レビューで行うこと:
  - 改善対象件数（30%超 or 30分超）を数える。
  - 過小見積り/過大見積りの偏りを確認する。
  - 共通要因（調査長期化、テスト待機、仕様往復など）を抽出する。
- 反映条件:
  - 同系統のズレが2件以上、または単発でも `Drift率 > 100%` かつ `|Drift| > 60分`。
- 反映先:
  - `docs/agent/ESTIMATION_HEURISTICS.md` の基本ルール追記/修正
  - `docs/agent/ESTIMATION_LOG.md` の日次レビューエントリ記録

## 改善のやり方
- `docs/agent/ESTIMATION_LOG.md` の差分要因から、再発しやすいズレ（例: ビルドが遅い、依存更新が必要）を抽出して、このファイルに追記します。
- ルールを更新した場合は、更新日を最上部に追記します（例: `更新日: 2026-02-07`）。
