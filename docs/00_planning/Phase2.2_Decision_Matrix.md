# Phase 2.2 機能判定シート (Decision Matrix)

**目的**: Phase 2.2 (UX改善フェーズ) で実装する機能の詳細を整理する。
※ リファクタリング(旧Phase 2.2)は Phase 2.x へ延期されました。

**目的**: Phase 2.2 で実装する **UX改善機能** の詳細を整理し、要否判定の材料とする。

---

## 📍 Phase 2.2 の位置づけ

ロードマップ (`03_Phase2ロードマップ`) における Phase 2.2 の定義：

> **会話・データ安定化（テキスト主導）**
> 騒音環境やプライバシー配慮が必要な現場のために、音声だけでなく「テキストとタップ」で完結するUXを提供する。

なお、Phase 2.1 (Security) は実装完了済み、Phase 2.2 (Refactoring) は保留となっています。

---

## 🚦 進捗サマリ (Pre-Phase Check)

### Phase 2.1: Security & Ops (実装済)

| ID | 機能名 | 判定 | 状態 |
| :--- | :--- | :--- | :--- |
| **SEC-01** | レート制限 (30req/min) | ✅ 採用 | **実装済** |
| **SEC-02** | Origin Allowlist | ✅ 採用 | **実装済** |
| **SEC-03** | 入力検証 (Length/Zod) | ✅ 採用 | **実装済** |
| **SEC-04** | 鍵管理手順書 | ✅ 採用 | **作成済** |
| **SEC-05** | コスト監視アラート | ❌ 非採用 | - |

### Phase 2.2: Refactoring (保留中)

| ID | 機能名 | 判定 | 理由 |
| :--- | :--- | :--- | :--- |
| **RF-01** | 構造化出力 (JSON Mode) | ⏸ **保留** | 機能実装を優先するため |
| **RF-02** | Store分割 (Slicing) | ⏸ **保留** | 同上 |

---

## 📱 Phase 2.2 機能候補（UX改善）

今回の判定対象です。

### UX-01: 待機フィラー演出 (Waiting Filler)

| 項目 | 内容 |
| :--- | :--- |
| **概要** | AIの応答待ち時間（数秒）の間、無音にならず「確認しています...」等の音声を再生する |
| **目的** | 「通信が切れた？」という現場の不安感を解消し、会話のリズムを維持する |
| **実装案** | AIリクエスト直後にローカルの短い音声ファイルを再生する |
| **コスト** | 低（`useTTS` フックの改修のみ） |
| **推奨案** | ✅ **採用**（体感品質への効果大）<br>**設定**: 文言「了解。」/ 遅延 350ms / 頻度: 低（思考時間が長い時のみ） |

### UX-02: 手袋モード (Glove Mode)

| 項目 | 内容 |
| :--- | :--- |
| **概要** | 誤タップを防ぐため、操作エリアを拡大し、スワイプ操作に対応する |
| **仕様** | 画面下部50%をタッチエリア化 / 左スワイプでキャンセル、右で送信 |
| **目的** | 軍手・皮手袋をしたままでもストレスなく操作できるようにする |
| **コスト** | 中（UIコンポーネントの新規作成とタッチイベント制御） |
| **推奨案** | ✅ **採用**（「現場で使える」ための必須機能） |

### UX-03: ハイブリッド入力 (Chips UI)

| 項目 | 内容 |
| :--- | :--- |
| **概要** | AIの質問に対して、タップで回答できる「選択肢チップ」を表示する |
| **例** | AI「高所作業ですか？」→ チップ[はい] [いいえ] |
| **目的** | 騒音下や声を出せない状況での入力を補助する |
| **コスト** | 低〜中（AIプロンプトで候補を出させるか、固定ルールにするか検討要） |
| **推奨案** | ✅ **採用**（テキスト入力の手間削減） |

### UX-04: タグ選択UI (Danger Tags)

| 項目 | 内容 |
| :--- | :--- |
| **概要** | 「よくある危険」をタグとして一覧表示し、ワンタップで入力可能にする |
| **例** | [転落] [挟まれ] [熱中症] [感電] などのプリセットボタン |
| **目的** | キーボード入力が苦手な高齢作業員の負担を軽減する |
| **コスト** | 低（固定リストの表示実装のみ） |
| **推奨案** | ✅ **採用**（入力ハードルを下げる） |

### UX-05: 完了の儀式化 (Completion Ritual)

| 項目 | 内容 |
| :--- | :--- |
| **概要** | KY活動完了時に、ファンファーレや「ヨシ！」の表示など、達成感を演出する |
| **目的** | 「やらされ仕事」になりがちなKY活動に区切りとポジティブな感情を与える |
| **コスト** | 低（アニメーション/効果音の追加） |
| **推奨案** | ✅ **採用**（心理的効果） |

### UX-06: PDF出力 (Report Generation)

| 項目 | 内容 |
| :--- | :--- |
| **概要** | 完了したKY活動記録をPDFファイルとして生成・ダウンロード可能にする |
| **技術** | `@react-pdf/renderer` を使用（クライアントサイド生成） |
| **目的** | デジタルデータを「日報」として提出可能にする（実用化の第一歩） |
| **コスト** | 中（日本語フォント対応、レイアウト調整） |
| **推奨案** | ✅ **採用**（成果物として必須） |

### UX-07: 音声認識 (Speech Recognition)

| 項目 | 内容 |
| :--- | :--- |
| **概要** | ブラウザ標準API (`Web Speech API`) を使用した音声入力 |
| **目的** | ハンズフリー入力の実現 |
| **課題** | iOS Safariでの動作制約（無音で切れる等）、Androidでの精度ブレ |
| **コスト** | 中〜高（ブラウザ差異の吸収） |
| **推奨案** | ⏸ **保留 または 試験的導入**（テキスト主導を優先し、あくまで補助として入れる） |

---

## 📊 判定欄 (Decision Log)

| ID | 機能名 | コスト | 推奨 | ユーザー判定 | 備考 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **UX-01** | フィラー演出 | 低 | 採用 | ✅ **採用** | 設定: 「了解。」(350ms) |
| **UX-02** | 手袋モード | 中 | 採用 | ❌ **不採用** | いったん見送り |
| **UX-03** | ハイブリッド入力 | 中 | 採用 | ⏸ **保留** | (未指示のため保留) |
| **UX-04** | タグ選択UI | 低 | 採用 | ❌ **不採用** | いったん見送り |
| **UX-05** | 完了演出 | 低 | 採用 | ⏸ **保留** | (未指示のため保留) |
| **UX-06** | PDF出力 | 中 | 採用 | ✅ **採用** | (前回最優先候補) |
| **UX-07** | 音声認識 | 中 | 保留 | ✅ **採用** | **積極採用**。初期はブラウザ標準、将来的には **Groq (Whisper)** で高速・高精度化するロードマップ。 |

---

## 📝 結論（ユーザー記入用）

次に実装する機能をここから **1つまたは2つ** 選定してください。

1.  
2.  
